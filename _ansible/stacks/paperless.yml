paperless:
  sablier:
    group: paperless
    displayName: Paperless
  envFileTemplate:
    template: paperless.env.j2
    secret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33366135323632373230663136626238613431333931396536613437373232343732666437323565
          6561326633323864326666333733336565383061623031620a393663363639636432613364353365
          62346133303666336562326333323566343765353134373536303463393661373463303739643930
          3963336563303236330a653861353234633264636533393662333465656264613032333037393135
          61643031613363623033326564363832333337363133343231396463336263623131616561643063
          3832336530343464336637643539396263306232343263396664
  services:
  - name: db16
    image: postgres:17.5@sha256:aadf2c0696f5ef357aa7a68da995137f0cf17bad0bf6e1f17de06ae5c769b302
    env:
      POSTGRES_DB: paperless
      POSTGRES_USER: paperless
      POSTGRES_PASSWORD: paperless
    volumes:
      - local: pgdata16
        container: /var/lib/postgresql/data
  - name: broker
    image: redis:7.4.6-alpine@sha256:3b73847e72874be07e6657b129a94761662b79bc0f679273757d4218573b2a98
    volumes:
      - local: redisdata
        container: /data
  - name: paperless
    image: ghcr.io/paperless-ngx/paperless-ngx:2.19.4@sha256:7ec0797af256194f6e117d1b7ed3ef91ad31b4a14bf3092abdee6bb74f6b3656
    envFile: true
    exposed:
      internal: true
      external: true
      port: 8000
    env:
      PAPERLESS_REDIS: redis://broker:6379
      PAPERLESS_DBHOST: db16
      PAPERLESS_TIKA_ENABLED: 1
      PAPERLESS_TIKA_GOTENBERG_ENDPOINT: http://gotenberg:3000
      PAPERLESS_TIKA_ENDPOINT: http://tika:9998
    volumes:
      - local: data
        container: /usr/src/paperless/data
      - shared: paperlessMedia
        container: /usr/src/paperless/media
      - shared: paperlessExport
        container: /usr/src/paperless/export
      - shared: paperlessConsume
        container: /usr/src/paperless/consume
    dependsOn:
      - db16
      - broker
      - gotenberg
      - tika
    healthcheck:
      url: http://localhost:8000
  - name: gotenberg
    image: docker.io/gotenberg/gotenberg:8.24@sha256:b116a40a1c24917e2bf3e153692da5acd2e78e7cd67e1b2d243b47c178f31c90
    command: "gotenberg --chromium-disable-javascript=true --chromium-allow-list=file:///tmp/.*"
  - name: tika
    image: ghcr.io/paperless-ngx/tika:2.9.1-minimal@sha256:20db3df89eaeb1b271dd840888fe909b88b12f4b86ef641ec07a1d45d4c5168f
