paperless:
  sablier:
    group: paperless
    displayName: Paperless
  envFileTemplate:
    template: paperless.env.j2
    secret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33366135323632373230663136626238613431333931396536613437373232343732666437323565
          6561326633323864326666333733336565383061623031620a393663363639636432613364353365
          62346133303666336562326333323566343765353134373536303463393661373463303739643930
          3963336563303236330a653861353234633264636533393662333465656264613032333037393135
          61643031613363623033326564363832333337363133343231396463336263623131616561643063
          3832336530343464336637643539396263306232343263396664
  services:
  - name: db18
    image: postgres:18.1
    env:
      POSTGRES_DB: paperless
      POSTGRES_USER: paperless
      POSTGRES_PASSWORD: paperless
    volumes:
      - local: pgdata18
        container: /var/lib/postgresql
  - name: broker
    image: redis:8.6.0-alpine@sha256:fd83658b0e40e2164617d262f13c02ca9ee9e1e6b276fd2fa06617e09bd5c780
    volumes:
      - local: redisdata
        container: /data
  - name: paperless
    image: ghcr.io/paperless-ngx/paperless-ngx:2.19.5@sha256:5f2a72fd7be42c6b1d8fa1751606a140452d4c3e6e829ae6b1b15e3c95129481
    envFile: true
    exposed:
      internal: true
      external: true
      port: 8000
    env:
      PAPERLESS_REDIS: redis://broker:6379
      PAPERLESS_DBHOST: db16
      PAPERLESS_TIKA_ENABLED: 1
      PAPERLESS_TIKA_GOTENBERG_ENDPOINT: http://gotenberg:3000
      PAPERLESS_TIKA_ENDPOINT: http://tika:9998
    volumes:
      - local: data
        container: /usr/src/paperless/data
      - shared: paperlessMedia
        container: /usr/src/paperless/media
      - shared: paperlessExport
        container: /usr/src/paperless/export
      - shared: paperlessConsume
        container: /usr/src/paperless/consume
    dependsOn:
      - db16
      - broker
      - gotenberg
      - tika
    healthcheck:
      url: http://localhost:8000
  - name: gotenberg
    image: docker.io/gotenberg/gotenberg:8.27@sha256:d71ab8c13b6bd47c7bc81195082005dfb17eaa75e8b1fadd347a64ee66ed98d5
    command: "gotenberg --chromium-disable-javascript=true --chromium-allow-list=file:///tmp/.*"
  - name: tika
    image: docker.io/apache/tika:3.2.3.0
